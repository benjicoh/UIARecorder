<Window x:Class="Recorder.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Recorder"
        xmlns:viewModels="clr-namespace:Recorder.ViewModels"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:tb="http://www.hardcodet.net/taskbar"
        Style="{DynamicResource MaterialDesignWindow}"
        Foreground="White"
        mc:Ignorable="d"
        Title="Recorder"
        SizeToContent="Height"
        Width="900">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <tb:TaskbarIcon
            x:Name="TaskbarIcon"
            IconSource="/Resources/recorder.ico"
            ToolTipText="{Binding TrayToolTipText}">
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Show/Hide" Command="{Binding ShowWindowCommand}" />
                    <MenuItem Header="Exit" Command="{Binding ExitApplicationCommand}" />
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
        </tb:TaskbarIcon>

        
        <StackPanel Grid.Row="0" Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Margin="10">
            <TextBlock Margin="10"
                       FontSize="18"
                       Text="Record"
                       VerticalAlignment="Center"/>
            <ToggleButton Width="64"
                          Height="32"
                          VerticalAlignment="Center"
                          HorizontalAlignment="Center"
                          Style="{StaticResource MaterialDesignSwitchDarkToggleButton}"
                          IsChecked="{Binding IsRecording}"
                          Command="{Binding ToggleRecordingCommand}"
                          materialDesign:ButtonProgressAssist.IsIndeterminate="False">
            </ToggleButton>
            <TextBlock Margin="30,10,10,10"
                       FontSize="18"
                       Text="Capture Mode"
                       VerticalAlignment="Center"/>
            <ComboBox Width="150"
                      ItemsSource="{Binding CaptureModes}"
                      SelectedItem="{Binding SelectedCaptureMode}"
                      VerticalAlignment="Center"/>

            <Button Content="Select Area"
                    Command="{Binding SelectCaptureAreaCommand}"
                    Margin="10"
                    IsEnabled="{Binding IsNotRecording}"/>
            <TextBlock Text="{Binding CaptureAreaInfo}"
                       VerticalAlignment="Center"
                       Margin="10"/>
        </StackPanel>

        <Expander Grid.Row="1"
                  Header="Test Creation Flow"
                  IsExpanded="True"
                  Margin="10">
            <StackPanel>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{Binding ProjectDirectoryPath, FallbackValue='No project selected'}"
                               VerticalAlignment="Center"
                               Margin="5"
                               TextTrimming="CharacterEllipsis"
                               Grid.Column="0" />
                    <Button Content="Browse"
                            Command="{Binding BrowseProjectDirectoryCommand}"
                            Grid.Column="1"
                            Margin="5"
                            IsEnabled="{Binding IsNotGenerating}" />
                </Grid>

                <Button Content="Generate Test"
                        Command="{Binding GenerateTestCommand}"
                        Margin="5"
                        IsEnabled="{Binding IsNotRecording}" />

                <ProgressBar IsIndeterminate="{Binding IsGenerating}"
                             Margin="5"
                             Height="10"
                             Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToVisibilityConverter}}" />
            </StackPanel>
        </Expander>
        
        <Expander Grid.Row="2" Header="Logs" IsExpanded="False" Margin="10">
            <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="300">
                <ItemsControl ItemsSource="{Binding LogMessages}" />
            </ScrollViewer>
        </Expander>

       
    </Grid>
</Window>
